---
name: useAPI
route: /useAPI
menu: '中台 hooks'
edit: false
sidebar: true
---

import JackBox from 'jackbox';
import { Playground } from 'docz';

import Demo1 from './demo/demo1';
import Demo1Code from '!raw-loader!./demo/demo1';
import Demo2 from './demo/demo2';
import Demo2Code from '!raw-loader!./demo/demo2';
import Demo3 from './demo/demo3';
import Demo3Code from '!raw-loader!./demo/demo3';

# useAPI

一个内置 `umi-request`，帮你管理网络请求的 Hook，支持立即执行，手动触发执行，轮询。

## 代码演示

### 立即执行

<JackBox file={Demo1Code} demoName='立即执行'>
  <Demo1 />
</JackBox>

### 手动触发执行

<JackBox file={Demo2Code} demoName='手动触发执行'>
  <Demo2 />
</JackBox>

### 轮询

<JackBox file={Demo3Code} demoName='轮询'>
  <Demo3 />
</JackBox>

## API

```
// 仅需配置一次，设置发送请求所使用的方法
configRequest(requestMethod);

const { // 返回数据同 useAsync
  loading: boolean;
  error?: Error;
  data?: T;
  cancel: () => void;
  run: () => Promise<T>;
  timer: {
    stop: () => void;
    resume: () => void;
    pause: () => void;
  };
} = useAPI(params)

params: {
  url: string;
  options?: RequestInit;
  manual?: boolean;
  pollingInterval?: number;
  onSuccess?: (d: T) => void;
  onError?: (e: Error) => void;
  fetch?: (url: string, options?: RequestInit) => Promise<T>;
}
```